
#include "lr_wpan_support_15_4a.h"
#include "channel_buffer.h"
#include "Physical_Layer.h"
#include <math.h>
#include "wlan_support.h"
#include <stdio.h>


/*Matrix of the number of uncorrected errors in 802.15.4a .each square corresponds to 
 a value of SINR ( 1 to 10dB, 10 in total), each of the 16 columns refers to a value of overlap( 25% to 100%, spaced 5%),
the rows(23 in each square) scan SNR(18 to 40dB spaced 1dB) the index is:= (int)((16*23)*SINR_q+SNR_q*16+overlap_q); */

double	MATRIX []= 
	{
	
	
      
0,5.5442,19.714,38.065,61.051,88.975,121.96,159.92,202.59,249.5,300.04,353.45,408.92,465.6,522.63,579.19,
0,0,0,13.015,31.369,55.263,85.222,121.52,164.11,212.66,266.52,324.8,386.41,450.17,514.83,579.19,
0,0,0,0,8.5569,27.374,52.838,85.768,126.61,175.36,231.53,294.15,361.9,433.15,506.17,579.19,
0,0,0,0,0,6.0428,25.993,54.024,91.322,138.53,195.59,261.7,335.34,414.42,496.55,579.19,
0,0,0,0,0,0,5.3849,27.445,59.528,103.27,159.45,227.77,306.74,393.85,485.86,579.19,
0,0,0,0,0,0,0,6.7707,32.406,70.786,124.02,192.84,276.22,371.34,473.99,579.19,
0,0,0,0,0,0,0,0,10.804,42.298,90.416,157.61,243.97,346.79,460.81,579.19,
0,0,0,0,0,0,0,0,0,18.806,59.836,122.97,210.38,320.18,446.18,579.19,
0,0,0,0,0,0,0,0,0,0.87942,33.428,89.994,175.99,291.53,429.98,579.19,
0,0,0,0,0,0,0,0,0,0,12.078,59.869,141.56,260.98,412.06,579.19,
0,0,0,0,0,0,0,0,0,0,0,33.734,108.04,228.79,392.28,579.19,
0,0,0,0,0,0,0,0,0,0,0,12.493,76.554,195.38,370.55,579.19,
0,0,0,0,0,0,0,0,0,0,0,0,48.285,161.38,346.75,579.19,
0,0,0,0,0,0,0,0,0,0,0,0,24.302,127.61,320.86,579.19,
0,0,0,0,0,0,0,0,0,0,0,0,5.3577,95.095,292.9,579.19,
0,0,0,0,0,0,0,0,0,0,0,0,0,64.986,262.97,579.19,
0,0,0,0,0,0,0,0,0,0,0,0,0,38.442,231.33,579.19,
0,0,0,0,0,0,0,0,0,0,0,0,0,16.444,198.38,579.19,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,164.71,579.19,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,131.12,579.19,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,98.601,579.19,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,68.3,579.19,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,41.381,579.19,

0,3.9033,17.19,34.39,55.947,82.175,113.23,149.07,189.5,234.13,282.42,333.71,387.27,442.29,497.97,553.55,
0,0,0,10.215,27.179,49.306,77.132,110.97,150.86,196.57,247.58,303.12,362.25,423.87,486.83,550,
0,0,0,0,5.4289,22.541,45.788,75.998,113.69,158.99,211.57,270.67,335.17,403.64,474.49,546.05,
0,0,0,0,0,2.4775,20.295,45.489,79.269,122.4,175.04,236.66,306.07,381.51,460.82,541.66,
0,0,0,0,0,0,1.1886,20.507,48.88,87.995,138.86,201.55,275.06,357.37,445.69,536.77,
0,0,0,0,0,0,0,1.6146,23.612,57.021,104.09,166,242.37,331.19,428.98,531.31,
0,0,0,0,0,0,0,0,4.1268,30.623,71.924,130.86,208.39,302.96,410.54,525.22,
0,0,0,0,0,0,0,0,0,9.6252,43.548,97.201,173.7,272.79,390.24,518.42,
0,0,0,0,0,0,0,0,0,0,19.985,66.183,139.07,240.89,367.97,510.84,
0,0,0,0,0,0,0,0,0,0,1.85,38.98,105.49,207.63,343.66,502.37,
0,0,0,0,0,0,0,0,0,0,0,16.562,74.087,173.56,317.25,492.91,
0,0,0,0,0,0,0,0,0,0,0,0,46.045,139.44,288.8,482.36,
0,0,0,0,0,0,0,0,0,0,0,0,22.413,106.23,258.43,470.6,
0,0,0,0,0,0,0,0,0,0,0,0,3.8999,75.059,226.41,457.49,
0,0,0,0,0,0,0,0,0,0,0,0,0,47.094,193.18,442.91,
0,0,0,0,0,0,0,0,0,0,0,0,0,23.402,159.36,426.72,
0,0,0,0,0,0,0,0,0,0,0,0,0,4.7231,125.79,408.78,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,93.486,388.96,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,63.614,367.16,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,37.326,343.27,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,15.59,317.28,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,289.21,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,259.19,

0,2.3637,14.824,30.945,51.159,75.784,105,138.81,177.08,219.48,265.56,314.73,366.33,419.62,473.86,528.31,
0,0,0,7.6288,23.304,43.784,69.608,101.12,138.44,181.4,229.61,282.43,339.01,398.39,459.51,521.29,
0,0,0,0,2.5894,18.141,39.342,67.019,101.74,143.74,192.83,248.45,309.66,375.21,443.66,513.49,
0,0,0,0,0,0,15.195,37.799,68.323,107.62,156.01,213.24,278.39,350,426.19,504.82,
0,0,0,0,0,0,0,14.413,39.431,74.285,120.15,177.39,245.44,322.75,406.96,495.18,
0,0,0,0,0,0,0,0,16.034,44.981,86.384,141.72,211.19,293.49,385.85,484.46,
0,0,0,0,0,0,0,0,0,20.742,55.951,107.25,176.23,262.36,362.76,472.55,
0,0,0,0,0,0,0,0,0,2.1717,29.976,75.12,141.32,229.64,337.62,459.32,
0,0,0,0,0,0,0,0,0,0,9.2793,46.537,107.44,195.76,310.4,444.63,
0,0,0,0,0,0,0,0,0,0,0,22.547,75.731,161.36,281.18,428.34,
0,0,0,0,0,0,0,0,0,0,0,3.8399,47.375,127.28,250.12,410.32,
0,0,0,0,0,0,0,0,0,0,0,0,23.431,94.543,217.54,390.44,
0,0,0,0,0,0,0,0,0,0,0,0,4.6244,64.313,183.92,368.59,
0,0,0,0,0,0,0,0,0,0,0,0,0,37.748,149.94,344.67,
0,0,0,0,0,0,0,0,0,0,0,0,0,15.815,116.51,318.65,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,84.703,290.56,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,55.683,260.52,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,30.575,228.79,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,10.254,195.78,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,162.1,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128.57,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96.189,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,66.114,

0,0.91873,12.605,27.716,46.667,69.779,97.247,129.12,165.31,205.54,249.44,296.5,346.12,397.62,450.33,503.54,
0,0,0,5.2404,19.722,38.669,62.618,91.938,126.79,167.11,212.6,262.71,316.73,373.79,432.93,493.15,
0,0,0,0,0.012911,14.138,33.454,58.777,90.712,129.57,175.3,227.49,285.39,347.91,413.8,481.63,
0,0,0,0,0,0,10.639,30.884,58.407,94.111,138.47,191.42,252.32,319.99,392.81,468.86,
0,0,0,0,0,0,0,9.0739,31.072,62.025,103.21,155.24,217.9,290.09,369.87,454.72,
0,0,0,0,0,0,0,0,9.5294,34.503,70.732,119.91,182.68,258.36,344.9,439.07,
0,0,0,0,0,0,0,0,0,12.432,42.252,86.56,147.42,225.13,317.86,421.78,
0,0,0,0,0,0,0,0,0,0,18.769,56.393,113.06,190.85,288.82,402.7,
0,0,0,0,0,0,0,0,0,0,0.85209,30.538,80.738,156.2,257.9,381.73,
0,0,0,0,0,0,0,0,0,0,0,9.8327,51.635,122.06,225.4,358.74,
0,0,0,0,0,0,0,0,0,0,0,0,26.848,89.499,191.76,333.68,
0,0,0,0,0,0,0,0,0,0,0,0,7.1628,59.68,157.63,306.54,
0,0,0,0,0,0,0,0,0,0,0,0,0,33.747,123.85,277.37,
0,0,0,0,0,0,0,0,0,0,0,0,0,12.612,91.482,246.38,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,61.677,213.87,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,35.587,180.36,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,14.154,146.55,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,113.35,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,81.845,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,53.207,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,28.547,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8.7083,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,

0,0,10.526,24.689,42.454,64.14,89.955,119.98,154.16,192.3,234.07,279.03,326.66,376.34,427.43,479.3,
0,0,0,3.0347,16.411,33.934,56.129,83.383,115.9,153.69,196.51,243.96,295.41,350.1,407.16,465.67,
0,0,0,0,0,10.499,28.083,51.225,80.549,116.43,158.93,207.78,262.37,321.81,384.98,450.6,
0,0,0,0,0,0,6.5729,24.678,49.444,81.805,122.34,171.17,227.87,291.54,360.8,433.97,
0,0,0,0,0,0,0,4.4067,23.7,51.1,87.941,135.03,192.44,259.47,334.58,415.64,
0,0,0,0,0,0,0,0,3.9672,25.425,56.973,100.43,156.79,225.9,306.32,395.49,
0,0,0,0,0,0,0,0,0,5.4829,30.583,68.584,121.84,191.32,276.12,373.4,
0,0,0,0,0,0,0,0,0,0,9.5948,40.669,88.684,156.41,244.17,349.28,
0,0,0,0,0,0,0,0,0,0,0,17.673,58.514,122.06,210.84,323.08,
0,0,0,0,0,0,0,0,0,0,0,0.15127,32.47,89.336,176.67,294.84,
0,0,0,0,0,0,0,0,0,0,0,0,11.428,59.421,142.39,264.65,
0,0,0,0,0,0,0,0,0,0,0,0,0,33.452,108.97,232.78,
0,0,0,0,0,0,0,0,0,0,0,0,0,12.333,77.511,199.61,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,49.191,165.73,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,25.092,131.95,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,5.9834,99.269,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,68.816,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,41.763,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19.127,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.5602,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,

0,0,8.576,21.853,38.504,58.846,83.097,111.36,143.62,179.73,219.43,262.32,307.95,355.77,405.2,455.63,
0,0,0,0.99789,13.352,29.551,50.109,75.42,105.73,141.08,181.35,226.18,275.07,327.36,382.25,438.91,
0,0,0,0,0,7.1929,23.187,44.312,71.2,104.27,143.68,189.28,240.61,296.94,357.28,420.51,
0,0,0,0,0,0,2.9495,19.117,41.36,70.624,107.56,152.44,205.04,264.69,330.26,400.29,
0,0,0,0,0,0,0,0.33611,17.216,41.399,74.237,116.67,169.03,230.92,301.23,378.16,
0,0,0,0,0,0,0,0,0,17.593,44.94,83.141,133.44,196.1,270.29,354.02,
0,0,0,0,0,0,0,0,0,0,20.709,53.078,99.323,160.9,237.7,327.82,
0,0,0,0,0,0,0,0,0,0,2.1472,27.59,67.874,126.19,203.86,299.57,
0,0,0,0,0,0,0,0,0,0,0,7.4515,40.267,93.029,169.35,269.38,
0,0,0,0,0,0,0,0,0,0,0,0,17.485,62.597,134.97,237.49,
0,0,0,0,0,0,0,0,0,0,0,0,0.092721,36.046,101.73,204.25,
0,0,0,0,0,0,0,0,0,0,0,0,0,14.313,70.759,170.26,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,43.234,136.27,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,20.182,103.28,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,2.2637,72.403,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,44.817,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,21.568,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3.3588,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,

0,0,6.7473,19.194,34.802,53.878,76.65,103.24,133.67,167.82,205.49,246.36,290,335.95,383.67,432.59,
0,0,0,0,10.526,25.498,44.528,68.018,96.231,129.27,167.06,209.35,255.71,305.57,358.24,412.95,
0,0,0,0,0,4.1905,18.73,37.993,62.613,93.046,129.52,171.98,220.11,273.31,330.76,391.44,
0,0,0,0,0,0,0,14.143,34.085,60.489,94.063,135.18,183.8,239.46,301.27,367.96,
0,0,0,0,0,0,0,0,11.528,32.811,61.983,100.07,147.6,204.47,269.89,342.45,
0,0,0,0,0,0,0,0,0,10.866,34.467,67.875,112.5,168.96,236.9,314.88,
0,0,0,0,0,0,0,0,0,0,12.404,39.799,79.659,133.78,202.7,285.33,
0,0,0,0,0,0,0,0,0,0,0,16.809,50.291,99.977,167.91,253.96,
0,0,0,0,0,0,0,0,0,0,0,0,25.478,68.706,133.34,221.06,
0,0,0,0,0,0,0,0,0,0,0,0,5.9604,41.146,100.02,187.14,
0,0,0,0,0,0,0,0,0,0,0,0,0,18.295,69.077,152.85,
0,0,0,0,0,0,0,0,0,0,0,0,0,0.74873,41.698,119.09,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,18.889,86.929,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,1.2741,57.537,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,32.046,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,11.346,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,

0,0,5.032,16.702,31.331,49.218,70.593,95.596,124.27,156.54,192.25,231.13,272.81,316.88,362.85,410.2,
0,0,0,0,7.9165,21.75,39.358,61.141,87.381,118.22,153.64,193.45,237.32,284.76,335.17,387.85,
0,0,0,0,0,1.4656,14.673,32.223,54.738,82.698,116.38,155.84,200.85,250.95,305.46,363.49,
0,0,0,0,0,0,0,9.6991,27.549,51.324,81.762,119.32,164.12,215.86,273.86,337.08,
0,0,0,0,0,0,0,0,6.5504,25.232,51.063,85.12,128.08,180.07,240.62,308.65,
0,0,0,0,0,0,0,0,0,5.1081,25.394,54.47,93.839,144.39,206.17,278.26,
0,0,0,0,0,0,0,0,0,0,5.4596,28.502,62.618,109.81,171.11,246.15,
0,0,0,0,0,0,0,0,0,0,0,7.9992,35.579,77.487,136.24,212.65,
0,0,0,0,0,0,0,0,0,0,0,0,13.638,48.605,102.58,178.3,
0,0,0,0,0,0,0,0,0,0,0,0,0,24.238,71.267,143.86,
0,0,0,0,0,0,0,0,0,0,0,0,0,5.1111,43.489,110.25,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,20.268,78.602,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,2.2571,50.084,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25.784,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6.4838,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,

0,0,3.4228,14.367,28.077,44.847,64.904,88.402,115.4,145.88,179.69,216.62,256.37,298.56,342.76,388.51,
0,0,0,0,5.5061,18.285,34.571,54.758,79.14,107.89,141.04,178.46,219.89,264.93,313.05,363.63,
0,0,0,0,0,0,10.985,26.961,47.527,73.175,104.23,140.81,182.79,229.85,281.4,336.69,
0,0,0,0,0,0,0,5.7352,21.689,43.055,70.585,104.8,145.94,193.85,248.06,307.73,
0,0,0,0,0,0,0,0,2.2047,18.561,41.365,71.711,110.38,157.69,213.44,276.84,
0,0,0,0,0,0,0,0,0,0.19869,17.567,42.757,77.31,122.3,178.11,244.26,
0,0,0,0,0,0,0,0,0,0,0,18.954,47.958,88.802,142.86,210.37,
0,0,0,0,0,0,0,0,0,0,0,0.85818,23.383,58.392,108.66,175.71,
0,0,0,0,0,0,0,0,0,0,0,0,4.2719,32.212,76.668,141.07,
0,0,0,0,0,0,0,0,0,0,0,0,0,11.131,48.06,107.41,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,23.904,75.852,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,4.9273,47.587,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,23.674,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4.8495,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,

0,0,1.9128,12.177,25.028,40.747,59.564,81.637,107.05,135.79,167.78,202.83,240.68,281.01,323.43,367.52,
0,0,0,0,3.2801,15.084,30.141,48.838,71.475,98.249,129.23,164.35,203.41,246.07,291.9,340.34,
0,0,0,0,0,0,7.6345,22.165,40.931,64.426,93.007,126.85,165.92,209.99,258.59,311.11,
0,0,0,0,0,0,0,2.2035,16.442,35.609,60.454,91.546,129.2,173.42,223.89,279.95,
0,0,0,0,0,0,0,0,0,12.707,32.781,59.728,94.395,137.26,188.33,247.1,
0,0,0,0,0,0,0,0,0,0,10.843,32.573,62.747,102.56,152.66,212.93,
0,0,0,0,0,0,0,0,0,0,0,10.933,35.434,70.525,117.81,178,
0,0,0,0,0,0,0,0,0,0,0,0,13.363,42.34,84.914,143.08,
0,0,0,0,0,0,0,0,0,0,0,0,0,19.012,55.155,109.14,
0,0,0,0,0,0,0,0,0,0,0,0,0,1.1328,29.655,77.299,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,9.2455,48.747,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24.557,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5.4749,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0



};


























































